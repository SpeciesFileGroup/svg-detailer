<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset=UTF-8" />
    <meta http-equiv="Content-Security-Policy" content="default-src *; style-src 'self' 'unsafe-inline'; script-src 'self' 'unsafe-inline' 'unsafe-eval' http://www.google.com">
    <title>svg-detailer demo</title>
    <script src="../src/svg-detailer.js"></script>
  </head>
  <body>
  <div>
    <label>Choose file to annotate: </label>
    <input id="image_file" type="file" onchange="getImage(event)">
  </div>
    <div id="container" style="overflow: hidden; left: 50px; top: 175px; position: inherit;" tabindex="0"
                        data-height="600"
                        data-width="600"
                        data-image=""
                        data-buttons='{"buttons": [
                        {"function": "polygon", "color": "FF0000"},
                        {"function": "polyline", "color": "FF0000"},
                        {"function": "line", "color": "FF0000"},
                        {"function": "rectangle", "color": "FF0000"},
                        {"function": "circle", "color": "FF0000"},
                        {"function": "ellipse", "color": "FF0000"},
                        {"function": "cubic", "color": "FF0000"},
                        {"function": "quadratic", "color": "FF0000"},
                        {"function": "draw", "color": "FF0000"},
                        {"function": "text", "color": "0000FF"}
                        ]}'>
    </div>
    <script>
      var svgDraw;
      function getImage(event) {
        let files = event.target.files;
        let svg_container = document.getElementById("container");
        let svg_element = svg_container.children[0];
        if(svg_element) {svg_element.parentNode.removeChild(svg_element)}  // remove any previously created svg element
        let svg_menu = document.getElementById("svgMenu");
        if(svg_menu) {svg_menu.parentNode.removeChild(svg_menu)}      // force removal of any created peer menu element

        if (FileReader && files && files.length) {
          var fileReader = new FileReader();
          fileReader.onload = (image) => {
            svg_container.attributes["data-image"].value = fileReader.result;
            svgDraw = new SVGDraw(svg_container);
          };
          fileReader.readAsDataURL(files[0])
        }
      }
    </script>
  </body>
</html>

