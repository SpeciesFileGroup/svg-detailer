(function(t,e){"object"===typeof exports&&"object"===typeof module?module.exports=e():"function"===typeof define&&define.amd?define([],e):"object"===typeof exports?exports["../demo/svg-detailer"]=e():t["../demo/svg-detailer"]=e()})("undefined"!==typeof self?self:this,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s="fae3")}({"02f4":function(t,e,r){var n=r("4588"),i=r("be13");t.exports=function(t){return function(e,r){var a,o,u=String(i(e)),l=n(r),s=u.length;return l<0||l>=s?t?"":void 0:(a=u.charCodeAt(l),a<55296||a>56319||l+1===s||(o=u.charCodeAt(l+1))<56320||o>57343?t?u.charAt(l):a:t?u.slice(l,l+2):o-56320+(a-55296<<10)+65536)}}},"0390":function(t,e,r){"use strict";var n=r("02f4")(!0);t.exports=function(t,e,r){return e+(r?n(t,e).length:1)}},"0bfb":function(t,e,r){"use strict";var n=r("cb7c");t.exports=function(){var t=n(this),e="";return t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.unicode&&(e+="u"),t.sticky&&(e+="y"),e}},"214f":function(t,e,r){"use strict";r("b0c5");var n=r("2aba"),i=r("32e9"),a=r("79e5"),o=r("be13"),u=r("2b4c"),l=r("520a"),s=u("species"),c=!a((function(){var t=/./;return t.exec=function(){var t=[];return t.groups={a:"7"},t},"7"!=="".replace(t,"$<a>")})),d=function(){var t=/(?:)/,e=t.exec;t.exec=function(){return e.apply(this,arguments)};var r="ab".split(t);return 2===r.length&&"a"===r[0]&&"b"===r[1]}();t.exports=function(t,e,r){var p=u(t),v=!a((function(){var e={};return e[p]=function(){return 7},7!=""[t](e)})),f=v?!a((function(){var e=!1,r=/a/;return r.exec=function(){return e=!0,null},"split"===t&&(r.constructor={},r.constructor[s]=function(){return r}),r[p](""),!e})):void 0;if(!v||!f||"replace"===t&&!c||"split"===t&&!d){var b=/./[p],h=r(o,p,""[t],(function(t,e,r,n,i){return e.exec===l?v&&!i?{done:!0,value:b.call(e,r,n)}:{done:!0,value:t.call(r,e,n)}:{done:!1}})),m=h[0],g=h[1];n(String.prototype,t,m),i(RegExp.prototype,p,2==e?function(t,e){return g.call(t,this,e)}:function(t){return g.call(t,this)})}}},"230e":function(t,e,r){var n=r("d3f4"),i=r("7726").document,a=n(i)&&n(i.createElement);t.exports=function(t){return a?i.createElement(t):{}}},"23c6":function(t,e,r){var n=r("2d95"),i=r("2b4c")("toStringTag"),a="Arguments"==n(function(){return arguments}()),o=function(t,e){try{return t[e]}catch(r){}};t.exports=function(t){var e,r,u;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=o(e=Object(t),i))?r:a?n(e):"Object"==(u=n(e))&&"function"==typeof e.callee?"Arguments":u}},"28a5":function(t,e,r){"use strict";var n=r("aae3"),i=r("cb7c"),a=r("ebd6"),o=r("0390"),u=r("9def"),l=r("5f1b"),s=r("520a"),c=r("79e5"),d=Math.min,p=[].push,v="split",f="length",b="lastIndex",h=4294967295,m=!c((function(){RegExp(h,"y")}));r("214f")("split",2,(function(t,e,r,c){var g;return g="c"=="abbc"[v](/(b)*/)[1]||4!="test"[v](/(?:)/,-1)[f]||2!="ab"[v](/(?:ab)*/)[f]||4!="."[v](/(.?)(.?)/)[f]||"."[v](/()()/)[f]>1||""[v](/.?/)[f]?function(t,e){var i=String(this);if(void 0===t&&0===e)return[];if(!n(t))return r.call(i,t,e);var a,o,u,l=[],c=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),d=0,v=void 0===e?h:e>>>0,m=new RegExp(t.source,c+"g");while(a=s.call(m,i)){if(o=m[b],o>d&&(l.push(i.slice(d,a.index)),a[f]>1&&a.index<i[f]&&p.apply(l,a.slice(1)),u=a[0][f],d=o,l[f]>=v))break;m[b]===a.index&&m[b]++}return d===i[f]?!u&&m.test("")||l.push(""):l.push(i.slice(d)),l[f]>v?l.slice(0,v):l}:"0"[v](void 0,0)[f]?function(t,e){return void 0===t&&0===e?[]:r.call(this,t,e)}:r,[function(r,n){var i=t(this),a=void 0==r?void 0:r[e];return void 0!==a?a.call(r,i,n):g.call(String(i),r,n)},function(t,e){var n=c(g,t,this,e,g!==r);if(n.done)return n.value;var s=i(t),p=String(this),v=a(s,RegExp),f=s.unicode,b=(s.ignoreCase?"i":"")+(s.multiline?"m":"")+(s.unicode?"u":"")+(m?"y":"g"),x=new v(m?s:"^(?:"+s.source+")",b),y=void 0===e?h:e>>>0;if(0===y)return[];if(0===p.length)return null===l(x,p)?[p]:[];var S=0,E=0,A=[];while(E<p.length){x.lastIndex=m?E:0;var N,w=l(x,m?p:p.slice(E));if(null===w||(N=d(u(x.lastIndex+(m?0:E)),p.length))===S)E=o(p,E,f);else{if(A.push(p.slice(S,E)),A.length===y)return A;for(var C=1;C<=w.length-1;C++)if(A.push(w[C]),A.length===y)return A;E=S=N}}return A.push(p.slice(S)),A}]}))},"2aba":function(t,e,r){var n=r("7726"),i=r("32e9"),a=r("69a8"),o=r("ca5a")("src"),u=r("fa5b"),l="toString",s=(""+u).split(l);r("8378").inspectSource=function(t){return u.call(t)},(t.exports=function(t,e,r,u){var l="function"==typeof r;l&&(a(r,"name")||i(r,"name",e)),t[e]!==r&&(l&&(a(r,o)||i(r,o,t[e]?""+t[e]:s.join(String(e)))),t===n?t[e]=r:u?t[e]?t[e]=r:i(t,e,r):(delete t[e],i(t,e,r)))})(Function.prototype,l,(function(){return"function"==typeof this&&this[o]||u.call(this)}))},"2b4c":function(t,e,r){var n=r("5537")("wks"),i=r("ca5a"),a=r("7726").Symbol,o="function"==typeof a,u=t.exports=function(t){return n[t]||(n[t]=o&&a[t]||(o?a:i)("Symbol."+t))};u.store=n},"2d00":function(t,e){t.exports=!1},"2d95":function(t,e){var r={}.toString;t.exports=function(t){return r.call(t).slice(8,-1)}},"2f21":function(t,e,r){"use strict";var n=r("79e5");t.exports=function(t,e){return!!t&&n((function(){e?t.call(null,(function(){}),1):t.call(null)}))}},"32e9":function(t,e,r){var n=r("86cc"),i=r("4630");t.exports=r("9e1e")?function(t,e,r){return n.f(t,e,i(1,r))}:function(t,e,r){return t[e]=r,t}},3846:function(t,e,r){r("9e1e")&&"g"!=/./g.flags&&r("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:r("0bfb")})},4588:function(t,e){var r=Math.ceil,n=Math.floor;t.exports=function(t){return isNaN(t=+t)?0:(t>0?n:r)(t)}},4630:function(t,e){t.exports=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}}},"4bf8":function(t,e,r){var n=r("be13");t.exports=function(t){return Object(n(t))}},"4f37":function(t,e,r){"use strict";r("aa77")("trim",(function(t){return function(){return t(this,3)}}))},"520a":function(t,e,r){"use strict";var n=r("0bfb"),i=RegExp.prototype.exec,a=String.prototype.replace,o=i,u="lastIndex",l=function(){var t=/a/,e=/b*/g;return i.call(t,"a"),i.call(e,"a"),0!==t[u]||0!==e[u]}(),s=void 0!==/()??/.exec("")[1],c=l||s;c&&(o=function(t){var e,r,o,c,d=this;return s&&(r=new RegExp("^"+d.source+"$(?!\\s)",n.call(d))),l&&(e=d[u]),o=i.call(d,t),l&&o&&(d[u]=d.global?o.index+o[0].length:e),s&&o&&o.length>1&&a.call(o[0],r,(function(){for(c=1;c<arguments.length-2;c++)void 0===arguments[c]&&(o[c]=void 0)})),o}),t.exports=o},5537:function(t,e,r){var n=r("8378"),i=r("7726"),a="__core-js_shared__",o=i[a]||(i[a]={});(t.exports=function(t,e){return o[t]||(o[t]=void 0!==e?e:{})})("versions",[]).push({version:n.version,mode:r("2d00")?"pure":"global",copyright:"© 2019 Denis Pushkarev (zloirock.ru)"})},"57e7":function(t,e,r){"use strict";var n=r("5ca1"),i=r("c366")(!1),a=[].indexOf,o=!!a&&1/[1].indexOf(1,-0)<0;n(n.P+n.F*(o||!r("2f21")(a)),"Array",{indexOf:function(t){return o?a.apply(this,arguments)||0:i(this,t,arguments[1])}})},"5ca1":function(t,e,r){var n=r("7726"),i=r("8378"),a=r("32e9"),o=r("2aba"),u=r("9b43"),l="prototype",s=function(t,e,r){var c,d,p,v,f=t&s.F,b=t&s.G,h=t&s.S,m=t&s.P,g=t&s.B,x=b?n:h?n[e]||(n[e]={}):(n[e]||{})[l],y=b?i:i[e]||(i[e]={}),S=y[l]||(y[l]={});for(c in b&&(r=e),r)d=!f&&x&&void 0!==x[c],p=(d?x:r)[c],v=g&&d?u(p,n):m&&"function"==typeof p?u(Function.call,p):p,x&&o(x,c,p,t&s.U),y[c]!=p&&a(y,c,v),m&&S[c]!=p&&(S[c]=p)};n.core=i,s.F=1,s.G=2,s.S=4,s.P=8,s.B=16,s.W=32,s.U=64,s.R=128,t.exports=s},"5f1b":function(t,e,r){"use strict";var n=r("23c6"),i=RegExp.prototype.exec;t.exports=function(t,e){var r=t.exec;if("function"===typeof r){var a=r.call(t,e);if("object"!==typeof a)throw new TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==n(t))throw new TypeError("RegExp#exec called on incompatible receiver");return i.call(t,e)}},"626a":function(t,e,r){var n=r("2d95");t.exports=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==n(t)?t.split(""):Object(t)}},6762:function(t,e,r){"use strict";var n=r("5ca1"),i=r("c366")(!0);n(n.P,"Array",{includes:function(t){return i(this,t,arguments.length>1?arguments[1]:void 0)}}),r("9c6c")("includes")},6821:function(t,e,r){var n=r("626a"),i=r("be13");t.exports=function(t){return n(i(t))}},"69a8":function(t,e){var r={}.hasOwnProperty;t.exports=function(t,e){return r.call(t,e)}},"6a99":function(t,e,r){var n=r("d3f4");t.exports=function(t,e){if(!n(t))return t;var r,i;if(e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;if("function"==typeof(r=t.valueOf)&&!n(i=r.call(t)))return i;if(!e&&"function"==typeof(r=t.toString)&&!n(i=r.call(t)))return i;throw TypeError("Can't convert object to primitive value")}},"6b54":function(t,e,r){"use strict";r("3846");var n=r("cb7c"),i=r("0bfb"),a=r("9e1e"),o="toString",u=/./[o],l=function(t){r("2aba")(RegExp.prototype,o,t,!0)};r("79e5")((function(){return"/a/b"!=u.call({source:"a",flags:"b"})}))?l((function(){var t=n(this);return"/".concat(t.source,"/","flags"in t?t.flags:!a&&t instanceof RegExp?i.call(t):void 0)})):u.name!=o&&l((function(){return u.call(this)}))},7726:function(t,e){var r=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=r)},"77f1":function(t,e,r){var n=r("4588"),i=Math.max,a=Math.min;t.exports=function(t,e){return t=n(t),t<0?i(t+e,0):a(t,e)}},"79e5":function(t,e){t.exports=function(t){try{return!!t()}catch(e){return!0}}},8378:function(t,e){var r=t.exports={version:"2.6.11"};"number"==typeof __e&&(__e=r)},"86cc":function(t,e,r){var n=r("cb7c"),i=r("c69a"),a=r("6a99"),o=Object.defineProperty;e.f=r("9e1e")?Object.defineProperty:function(t,e,r){if(n(t),e=a(e,!0),n(r),i)try{return o(t,e,r)}catch(u){}if("get"in r||"set"in r)throw TypeError("Accessors not supported!");return"value"in r&&(t[e]=r.value),t}},"87b3":function(t,e,r){var n=Date.prototype,i="Invalid Date",a="toString",o=n[a],u=n.getTime;new Date(NaN)+""!=i&&r("2aba")(n,a,(function(){var t=u.call(this);return t===t?o.call(this):i}))},"9b43":function(t,e,r){var n=r("d8e8");t.exports=function(t,e,r){if(n(t),void 0===e)return t;switch(r){case 1:return function(r){return t.call(e,r)};case 2:return function(r,n){return t.call(e,r,n)};case 3:return function(r,n,i){return t.call(e,r,n,i)}}return function(){return t.apply(e,arguments)}}},"9c6c":function(t,e,r){var n=r("2b4c")("unscopables"),i=Array.prototype;void 0==i[n]&&r("32e9")(i,n,{}),t.exports=function(t){i[n][t]=!0}},"9def":function(t,e,r){var n=r("4588"),i=Math.min;t.exports=function(t){return t>0?i(n(t),9007199254740991):0}},"9e1e":function(t,e,r){t.exports=!r("79e5")((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},a481:function(t,e,r){"use strict";var n=r("cb7c"),i=r("4bf8"),a=r("9def"),o=r("4588"),u=r("0390"),l=r("5f1b"),s=Math.max,c=Math.min,d=Math.floor,p=/\$([$&`']|\d\d?|<[^>]*>)/g,v=/\$([$&`']|\d\d?)/g,f=function(t){return void 0===t?t:String(t)};r("214f")("replace",2,(function(t,e,r,b){return[function(n,i){var a=t(this),o=void 0==n?void 0:n[e];return void 0!==o?o.call(n,a,i):r.call(String(a),n,i)},function(t,e){var i=b(r,t,this,e);if(i.done)return i.value;var d=n(t),p=String(this),v="function"===typeof e;v||(e=String(e));var m=d.global;if(m){var g=d.unicode;d.lastIndex=0}var x=[];while(1){var y=l(d,p);if(null===y)break;if(x.push(y),!m)break;var S=String(y[0]);""===S&&(d.lastIndex=u(p,a(d.lastIndex),g))}for(var E="",A=0,N=0;N<x.length;N++){y=x[N];for(var w=String(y[0]),C=s(c(o(y.index),p.length),0),F=[],M=1;M<y.length;M++)F.push(f(y[M]));var k=y.groups;if(v){var P=[w].concat(F,C,p);void 0!==k&&P.push(k);var I=String(e.apply(void 0,P))}else I=h(w,p,C,F,k,e);C>=A&&(E+=p.slice(A,C)+I,A=C+w.length)}return E+p.slice(A)}];function h(t,e,n,a,o,u){var l=n+t.length,s=a.length,c=v;return void 0!==o&&(o=i(o),c=p),r.call(u,c,(function(r,i){var u;switch(i.charAt(0)){case"$":return"$";case"&":return t;case"`":return e.slice(0,n);case"'":return e.slice(l);case"<":u=o[i.slice(1,-1)];break;default:var c=+i;if(0===c)return r;if(c>s){var p=d(c/10);return 0===p?r:p<=s?void 0===a[p-1]?i.charAt(1):a[p-1]+i.charAt(1):r}u=a[c-1]}return void 0===u?"":u}))}}))},aa77:function(t,e,r){var n=r("5ca1"),i=r("be13"),a=r("79e5"),o=r("fdef"),u="["+o+"]",l="​",s=RegExp("^"+u+u+"*"),c=RegExp(u+u+"*$"),d=function(t,e,r){var i={},u=a((function(){return!!o[t]()||l[t]()!=l})),s=i[t]=u?e(p):o[t];r&&(i[r]=s),n(n.P+n.F*u,"String",i)},p=d.trim=function(t,e){return t=String(i(t)),1&e&&(t=t.replace(s,"")),2&e&&(t=t.replace(c,"")),t};t.exports=d},aae3:function(t,e,r){var n=r("d3f4"),i=r("2d95"),a=r("2b4c")("match");t.exports=function(t){var e;return n(t)&&(void 0!==(e=t[a])?!!e:"RegExp"==i(t))}},b0c5:function(t,e,r){"use strict";var n=r("520a");r("5ca1")({target:"RegExp",proto:!0,forced:n!==/./.exec},{exec:n})},be13:function(t,e){t.exports=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t}},c366:function(t,e,r){var n=r("6821"),i=r("9def"),a=r("77f1");t.exports=function(t){return function(e,r,o){var u,l=n(e),s=i(l.length),c=a(o,s);if(t&&r!=r){while(s>c)if(u=l[c++],u!=u)return!0}else for(;s>c;c++)if((t||c in l)&&l[c]===r)return t||c||0;return!t&&-1}}},c69a:function(t,e,r){t.exports=!r("9e1e")&&!r("79e5")((function(){return 7!=Object.defineProperty(r("230e")("div"),"a",{get:function(){return 7}}).a}))},ca5a:function(t,e){var r=0,n=Math.random();t.exports=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++r+n).toString(36))}},cb7c:function(t,e,r){var n=r("d3f4");t.exports=function(t){if(!n(t))throw TypeError(t+" is not an object!");return t}},d3f4:function(t,e){t.exports=function(t){return"object"===typeof t?null!==t:"function"===typeof t}},d8e8:function(t,e){t.exports=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t}},ebd6:function(t,e,r){var n=r("cb7c"),i=r("d8e8"),a=r("2b4c")("species");t.exports=function(t,e){var r,o=n(t).constructor;return void 0===o||void 0==(r=n(o)[a])?e:i(r)}},f6fd:function(t,e){(function(t){var e="currentScript",r=t.getElementsByTagName("script");e in t||Object.defineProperty(t,e,{get:function(){try{throw new Error}catch(n){var t,e=(/.*at [^\(]*\((.*):.+:.+\)$/gi.exec(n.stack)||[!1])[1];for(t in r)if(r[t].src==e||"interactive"==r[t].readyState)return r[t];return null}}})})(document)},fa5b:function(t,e,r){t.exports=r("5537")("native-function-to-string",Function.toString)},fae3:function(t,e,r){"use strict";var n;(r.r(e),"undefined"!==typeof window)&&(r("f6fd"),(n=window.document.currentScript)&&(n=n.src.match(/(.+\/)[^/]+\.js(\?.*)?$/))&&(r.p=n[1]));r("6762"),r("4f37"),r("57e7"),r("a481"),r("28a5"),r("6b54"),r("87b3");var i,a,o,u,l,s,c,d,p,v,f,b,h,m,g,x=0,y=0,S="MOVE",E=6,A=1,N=4,w=.02,C=[],F=/Mac/.test(navigator.platform),M=!1,k="_",P=75,I="Verdana",L=10,H=!1,T=!1,O=0,B=!0,V={61:"=",106:"*",107:"+",109:"-",110:".",111:"/",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},_={"`":"~",1:"!",2:"@",3:"#",4:"$",5:"%",6:"^",7:"&",8:"*",9:"(",0:")","-":"_","=":"+",";":":","'":'"',"[":"{","]":"}",",":"<",".":">","/":"?","\\":"|"};function j(t){s=new Image,C=[],P=75,I="Verdana",S;var e=parseInt(t.attributes["data-width"].value),r=parseInt(t.attributes["data-height"].value);s.src=t.attributes["data-image"].value;var n=this;s.onload=function(i){c={top:t.offsetTop,left:t.offsetLeft},x=0,y=0;var d=e/r,p=s.width/s.height;l=document.createElementNS("http://www.w3.org/2000/svg","svg"),l.setAttributeNS(null,"id","svgLayer"),l.setAttribute("xmlns","http://www.w3.org/2000/svg"),l.setAttribute("xmlns:xlink","http://www.w3.org/1999/xlink"),l.setAttributeNS(null,"version","1.1"),l.setAttributeNS(null,"style","position: inherit;"),l.setAttributeNS(null,"width",e),l.setAttributeNS(null,"height",r),t.appendChild(l),u=(d>=1&&p>=1||d<=1&&p<=1)&&p<=d||p<=1&&d>=1?l.height.baseVal.value/s.height:l.width.baseVal.value/s.width,a=u,o=(E/a).toString(),m=u*s.width/2,g=u*s.height/2;var v=document.createElementNS("http://www.w3.org/2000/svg","g");v.setAttributeNS(null,"id","xlt"),v.setAttributeNS(null,"transform","translate(0,0) scale("+parseFloat(a)+")"),l.appendChild(v);var f=document.createElementNS("http://www.w3.org/2000/svg","image");f.setAttributeNS(null,"id","xltImage"),f.setAttributeNS(null,"x","0"),f.setAttributeNS(null,"y","0"),f.setAttributeNS(null,"width",s.width.toString()),f.setAttributeNS(null,"height",s.height.toString()),f.setAttributeNS(null,"preserveAspectRatio","none"),f.setAttributeNS("http://www.w3.org/1999/xlink","href",s.src),v.appendChild(f),j.prototype.buildSVGmenu(t),document.onkeydown=n.keyHandler(),document.onkeyup=n.keyUpHandler(),Pt(0,0,a),wt("MOVE"),n.renderFunction=n.updateSvgByElement,n.touchSupported="ontouchstart"in document.documentElement,n.containerID=t,n.lastMousePoint={x:0,y:0},n.touchSupported?(n.mouseDownEvent="touchstart",n.mouseMoveEvent="touchmove",n.mouseUpEvent="touchend"):(n.mouseDownEvent="mousedown",n.mouseMoveEvent="mousemove",n.mouseUpEvent="mouseup",l.ondblclick=n.doubleClickHandler()),l.onmousedown=n.onSvgMouseDown(),n.mouseMoveHandler=n.onSvgMouseMove,n.mouseUpHandler=n.onSvgMouseUp,l.onmouseup=n.mouseUpHandler(),l.onmousemove=n.mouseMoveHandler()}}function G(t,e){return parseInt(t)+", "+parseInt(e)}function D(t,e){return G(t,e)+", "}function R(){return O+=1,O}function U(t,e,r,n,i,a,o,u){return"cubic"==S?"M "+G(t,e)+" C "+D(r,n)+D(i,a)+G(o,u):"M "+G(t,e)+" Q "+D(r,n)+G(o,u)}function z(t){for(var e=t.replace(/,/g,"").split(" "),r=0,n=[],i=0;i<e.length;i++)mt(e[i])&&(n[r]=e[i],r++);return n}function $(t){return D(t[0],t[1])+" "+D(t[2],t[3])+" "+D(t[4],t[5])+" "+D(t[6],t[7])}function q(t){var e=document.createElementNS("http://www.w3.org/2000/svg",t);return e.setAttributeNS(null,"stroke",i),e.setAttributeNS(null,"stroke-width",A),e.setAttributeNS(null,"stroke-opacity","0.9"),e.setAttributeNS(null,"fill",""),e.setAttributeNS(null,"fill-opacity","0.0"),e.setAttributeNS(null,"stroke-linecap","round"),e}function J(t){return t.setAttributeNS(null,"onmouseover","this.attributes['stroke-width'].value = '"+1.5*A+"';"),t.setAttributeNS(null,"onmouseout","this.attributes['stroke-width'].value = "+A+";"),t}function Z(t){var e=f?f.id:"null",r=b?b.tagName:"null",n=b?b.parentElement.id:"null";Ut(B,"mouseenter eventTarget="+t.target.id+" thisGroup="+e+" thisElement="+r+" parent="+n+" "+S+" "),Y(t.target)}function K(t){var e=f?f.id:"null",r=b?b.tagName:"null",n=b?b.parentElement.id:"null";Ut(B,"mouseleave eventTarget="+t.target.id+" thisGroup="+e+" thisElement="+r+" parent="+n+" "+S+" "),Q(t.target)}function W(t){return null!=t&&void 0!=t||(t=null),t.removeEventListener("mouseenter",Z),t.removeEventListener("mouseleave",K),t.addEventListener("mouseenter",Z),t.addEventListener("mouseleave",K),t}function Y(t){if(X(t))Ut(B,"Element conflict: "+t.attributes.class.value);else{if(Ut(B,"setEditElement no conflict"),null==f){var e="thisGroup is NULL";b&&(e+=", thisElement = "+b.toString()),Ut(B,t.attributes.class.value+" "+e),f=t}S,t.firstChild&&("path"!=t.firstChild.tagName?S=t.attributes.class?t.attributes.class.value:t.firstChild.tagName:(S="cubic",-1==t.firstChild.attributes.d.value.indexOf("C ")&&(S="quadratic"))),T=!1,jt(S),t.childNodes.length>1&&"g"==t.lastChild.tagName&&Q(t);var r=ot(t);t.appendChild(r),Ut(B,"setEditElement "+t.id+" "+t.attributes.class.value)}}function Q(t){var e=f?f.id:"null";Ut(B,"clearEditElement: svgInProgress="+T+", group="+t.id+", thisGroup="+e),"SHIFT"!=T&&(t?H?Ut(B,"clearEditElement: waitElement"):f&&e!=t.id?Ut(B,"clearEditElement: group conflict"):(t.childNodes.length>1&&("circle"==t.lastChild.tagName||"g"==t.lastChild.tagName?(t.lastChild.remove(),h=null,S="MOVE",jt(S),T=!1,b=null,f=null):"text"==t.firstChild.tagName&&"text"==T&&Ht()),W(t),S="MOVE",jt(S),T=!1,b=null,f=null):Ut(B,"clearEditElement: group argument null"))}function X(t){return H?(Ut(B,"checkElementConflict1: waitElement = "+H),!0):T?"SHIFT"==T?(Ut(B,"checkElementConflict3: svgInProgress="+T+"thisGroup="+t.id),f.id!=t.id):T!=t.firstChild.tagName?(Ut(B,"checkElementConflict4: svgInProgress="+T+", thisElement="+b+", group element="+t.firstChild.tagName),!0):f!=t?(Ut(B,"checkElementConflict5: svgInProgress="+T+", thisGroup="+f.id+", group="+t.id+", group element="+t.firstChild.tagName),!0):void 0:(Ut(B,"checkElementConflict2: svgInProgress="+T+"thisGroup="+t.id),!1)}function tt(t){null==t&&Ut(B,"fault");while(t.childElementCount>1&&"g"==t.lastChild.tagName)t.lastChild.remove();T=!1,h=null,wt("MOVE"),W(t)}function et(t){f||(f=t.parentNode.parentNode),b=f.firstChild,h=f.children[1].children["shift"],S=b.tagName,f.attributes.class&&(S=f.attributes.class.value);for(var e=f.lastChild.childElementCount,r=e;r>1;r--)f.lastChild.lastChild.remove();f.removeEventListener("mouseenter",Z),f.removeEventListener("mouseleave",K),T="SHIFT",Ut(B,"svgInProgress = SHIFT, cursorMode = "+S)}function rt(t){var e=t.parentNode.parentNode;if(f=e,b=e.firstChild,h=e.lastChild.firstChild,S=b.tagName,"circle"==S||"ellipse"==S)for(var r=e.lastChild.childElementCount,n=r;n>0;n--)e.lastChild.lastChild.remove();T="SIZE",Ut(B,"svgInProgress = SIZE, cursorMode = "+S+" "+b.tagName),e.removeEventListener("mouseenter",Z),e.removeEventListener("mouseleave",K)}function nt(t){h=t;var e=t.parentNode.parentNode;f=e,b=e.firstChild,parseInt(t.id)==t.parentNode.childElementCount-1&&(h=t),"g"==t.parentNode.lastChild.tagName&&t.parentNode.lastChild.remove(),S=f.attributes.class?f.attributes.class.value:b.tagName,e.removeEventListener("mouseenter",Z),e.removeEventListener("mouseleave",K),t.removeEventListener("mousedown",(function(t){})),T="POINT"}function it(t){if(h==t);h=t;var e=t.parentNode.parentNode.parentNode;f=e,b=e.firstChild,parseInt(t.id)==t.parentNode.childElementCount-1&&(h=t),S=b.tagName,e.removeEventListener("mouseenter",Z),e.removeEventListener("mouseleave",K),b.attributes["points"].value=at(b,h),h.id=(parseInt(h.id)+1).toString(),T="NEW"}function at(t,e){for(var r=t.attributes["points"].value.trim().split(" "),n="",i=parseInt(e.id),a=e.attributes["cx"].value+","+e.attributes["cy"].value,o=0;o<r.length;o++)n+=r[o]+" ",o==i&&(n+=a+" ");return n}function ot(t){var e,r,n,i,a,o={};t||Ut(B,"group arg null, thisGroup="+f);var u=t.firstChild;if(o=ht(u.tagName),"path"!=u.tagName)for(var l in o)o[l]=bt(u,l);var s=document.createElementNS("http://www.w3.org/2000/svg","g");switch(u.tagName){case"circle":s.setAttributeNS(null,"class","bubbles");var c=o["cx"],d=o["cy"],p=o["r"];return s.appendChild(ut(c,d,"shift")),s.appendChild(lt(p+c,d,"E")),s.appendChild(lt(c,p+d,"S")),s.appendChild(lt(c-p,d,"W")),s.appendChild(lt(c,d-p,"N")),s;case"ellipse":c=o["cx"],d=o["cy"];var v=o["rx"],b=o["ry"];return s.appendChild(ut(c,d,"shift")),s.appendChild(lt(c+.707*v,d+.707*b,"SE")),s.appendChild(lt(c+.707*v,d-.707*b,"NE")),s.appendChild(lt(c-.707*v,d-.707*b,"NW")),s.appendChild(lt(c-.707*v,d+.707*b,"SW")),s;case"rect":var h=o["x"],m=o["y"],g=o["width"],x=o["height"];return s.appendChild(ut(h,m,"shift")),s.appendChild(lt(h+g,m+x)),s;case"line":var y=o["x1"],S=o["y1"],E=o["x2"],A=o["y2"];return s.appendChild(ut((E+y)/2,(A+S)/2,"shift")),s.appendChild(st(y,S,"x1-y1")),s.appendChild(st(E,A,"x2-y2")),s;case"path":var N,w,C=u.attributes["d"].value,F=C.indexOf("Q ")>0,M=z(C);return F&&(M[6]=M[4],M[7]=M[5],M[4]=M[2],M[5]=M[3]),F?(N=parseFloat(M[0])+parseFloat(M[2])+parseFloat(M[6]),w=parseFloat(M[1])+parseFloat(M[3])+parseFloat(M[7]),N=(N/3).toFixed(4),w=(w/3).toFixed(4)):(N=parseFloat(M[0])+parseFloat(M[2])+parseFloat(M[4])+parseFloat(M[6]),w=parseFloat(M[1])+parseFloat(M[3])+parseFloat(M[5])+parseFloat(M[7]),N=(N/4).toFixed(4),w=(w/4).toFixed(4)),s.appendChild(vt(M)),s.appendChild(ut(N,w,"shift")),s.appendChild(pt(M[0],M[1],M[2],M[3],"l1")),s.appendChild(pt(M[4],M[5],M[6],M[7],"l2")),s.appendChild(dt(M[0],M[1],"p1")),s.appendChild(dt(M[6],M[7],"p2")),s.appendChild(dt(M[2],M[3],"c1")),F||s.appendChild(dt(M[4],M[5],"c2")),s;case"polygon":case"polyline":var k=u.attributes["points"].value.trim();n=k.split(" ");var P=n[0].split(",");e=parseFloat(P[0]),r=parseFloat(P[1]);for(var I,L=0,H=0,T=0;T<n.length;T++)L+=e,H+=r,T<n.length-1&&(I=n[T+1].split(","),i=parseFloat(I[0]),a=parseFloat(I[1]),e=i,r=a);e=L/n.length,r=H/n.length,s.appendChild(ut(e,r,"shift"));var O=document.createElementNS("http://www.w3.org/2000/svg","g");e=parseFloat(P[0]),r=parseFloat(P[1]);for(var V=0;V<n.length;V++)s.appendChild(st(e,r,V.toString())),V<n.length-1&&(I=n[V+1].split(","),i=parseFloat(I[0]),a=parseFloat(I[1]),O.appendChild(ct(.5*(e+i),.5*(r+a),V.toString()+".5")),e=i,r=a);if("polygon"==u.tagName){P=n[0].split(","),e=parseFloat(P[0]),r=parseFloat(P[1]);var _=(n.length-1).toString()+".5";O.appendChild(ct(.5*(e+i),.5*(r+a),_))}return s.appendChild(O),s;case"text":return e=o["x"],r=o["y"],s.appendChild(ut(e,r,"shift")),s}}function ut(t,e,r){var n=ft(t,e);return n.setAttributeNS(null,"r",1.25*o),n.setAttributeNS(null,"stroke","#004477"),n.setAttributeNS(null,"fill-opacity","1.0"),n.addEventListener("mousedown",(function(t){et(n)})),n.addEventListener("mouseup",(function(t){W(n)})),n.setAttributeNS(null,"style","cursor:move;"),n.setAttributeNS(null,"id",r),n}function lt(t,e,r){var n=ft(t,e);return n.setAttributeNS(null,"fill-opacity","0.6"),n.addEventListener("mousedown",(function(t){rt(n)})),n.setAttributeNS(null,"id",r),n}function st(t,e,r){var n=ft(t,e);return n.setAttributeNS(null,"fill-opacity","0.6"),n.setAttributeNS(null,"id",r),n.addEventListener("mousedown",(function(t){nt(n)})),n.addEventListener("mouseup",(function(t){tt(f)})),n}function ct(t,e,r){var n=ft(t,e);return n.setAttributeNS(null,"r",.8*o),n.setAttributeNS(null,"stroke","#555555"),n.setAttributeNS(null,"stroke-opacity","0.6"),n.setAttributeNS(null,"fill-opacity","0.4"),n.addEventListener("mousedown",(function(t){it(n)})),n.addEventListener("mouseup",(function(t){tt(f)})),n.setAttributeNS(null,"id",r),n}function dt(t,e,r){var n=ft(t,e);return n.setAttributeNS(null,"stroke","#333333"),n.setAttributeNS(null,"stroke-opacity","0.6"),n.setAttributeNS(null,"fill-opacity","0.8"),n.addEventListener("mousedown",(function(t){nt(n)})),n.addEventListener("mouseup",(function(t){tt(t.target.parentElement.parentElement)})),n.setAttributeNS(null,"id",r),n}function pt(t,e,r,n,i){var a=q("line");return a.setAttributeNS(null,"x1",t),a.setAttributeNS(null,"y1",e),a.setAttributeNS(null,"x2",r),a.setAttributeNS(null,"y2",n),a.setAttributeNS(null,"id",i),a.setAttributeNS(null,"stroke-width","1"),a}function vt(t){var e=q("polyline");return e.setAttributeNS(null,"id","poly"),e.setAttributeNS(null,"points",$(t)),e.setAttributeNS(null,"stroke-opacity","0.0"),e}function ft(t,e){var r=q("circle");return isNaN(t)&&alert("offsetX: "+t.toString()),isNaN(e)&&alert("offsetY: "+e.toString()),r.setAttributeNS(null,"cx",t),r.setAttributeNS(null,"cy",e),r.setAttributeNS(null,"r",o),r.setAttributeNS(null,"fill","#FFFFFF"),r.setAttributeNS(null,"stroke","#222222"),r.setAttributeNS(null,"stroke-width",.25*o),r}function bt(t,e){return parseFloat(parseFloat(t.attributes[e].value).toFixed(1))}function ht(t){var e=0,r=0,n=1,i=1;switch(t){case"polyline":return{points:n};case"polygon":return{points:n};case"rect":return{x:e,y:r,width:n,height:i};case"line":return{x1:e,y1:r,x2:n,y2:i};case"circle":return{cx:e,cy:r,r:n};case"ellipse":return{cx:e,cy:r,rx:n,ry:i};case"path":return{x1:e,y1:r,xc1:n,yc1:i,xc2:n,yc2:i,x2:e,y2:r};case"text":return{x:e,y:r}}}function mt(t){return!isNaN(parseFloat(t))&&isFinite(t)}function gt(t,e,r,n){return Math.sqrt(Math.pow(t-r,2)+Math.pow(e-n,2))}j.prototype.onSvgMouseDown=function(){var t=this;return function(e){if(t.updateMousePosition(e),0!=T&&T!=S)return"SHIFT"==T?void 0:void(T=S);if(f&&f.childElementCount>1&&"text"!=S)return Q(f),!1;if("polygon"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var r=document.createElementNS("http://www.w3.org/2000/svg","g"),n="g"+R().toString();r.setAttributeNS(null,"id",n),r.setAttributeNS(null,"class",S),f=r,document.getElementById("xlt").appendChild(r);var o=q("polyline");r.appendChild(o),b=r.children[0],o.setAttributeNS(null,"points",C[0][0].toFixed(4).toString()+","+C[0][1].toFixed(4).toString()+" "+C[0][0].toFixed(4).toString()+","+C[0][1].toFixed(4).toString()+" "),T=S}else{t.updateMousePosition(e);var u=b.attributes["points"].value,l=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString()+" ";b.attributes["points"].value=u.concat(l)}if("polyline"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var s=document.createElementNS("http://www.w3.org/2000/svg","g");f=s;var c="g"+R().toString();s.setAttributeNS(null,"id",c),s.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(s);var d=q("polyline");s.appendChild(d),b=s.children[0],d.setAttributeNS(null,"stroke-linecap","round"),d.setAttributeNS(null,"points",C[0][0].toFixed(4).toString()+","+C[0][1].toFixed(4).toString()+" "+C[0][0].toFixed(4).toString()+","+C[0][1].toFixed(4).toString()+" "),T=S}else{t.updateMousePosition(e);var p=b.attributes["points"].value,v=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString()+" ";b.attributes["points"].value=p.concat(v)}if("rect"==S&&0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var h=document.createElementNS("http://www.w3.org/2000/svg","g"),E="g"+R().toString();h.setAttributeNS(null,"id",E),h.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(h);var A=q("rect");h.appendChild(A),f=h,b=h.children[0],A.setAttributeNS(null,"x",C[0][0].toFixed(4)),A.setAttributeNS(null,"y",C[0][1].toFixed(4)),A.setAttributeNS(null,"width",1),A.setAttributeNS(null,"height",1),T=S}if("line"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var N=document.createElementNS("http://www.w3.org/2000/svg","g");f=N;var w="g"+R().toString();N.setAttributeNS(null,"id",w),N.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(N);var F=q("line");N.appendChild(F),b=N.children[0],F.setAttributeNS(null,"x1",C[0][0].toFixed(4)),F.setAttributeNS(null,"y1",C[0][1].toFixed(4)),F.setAttributeNS(null,"x2",C[0][0].toFixed(4)),F.setAttributeNS(null,"y2",C[0][1].toFixed(4)),T=S}else T=!1,W(b);if("arrow"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var M=document.createElementNS("http://www.w3.org/2000/svg","g");f=M;var k="g"+R().toString();M.setAttributeNS(null,"id",k),M.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(M);var L=q("line");M.appendChild(L),b=M.children[0],L.setAttributeNS(null,"x1",C[0][0].toFixed(4)),L.setAttributeNS(null,"y1",C[0][1].toFixed(4)),L.setAttributeNS(null,"x2",C[0][0].toFixed(4)),L.setAttributeNS(null,"y2",C[0][1].toFixed(4)),T=S}else T=!1,W(b);if("circle"==S&&0==T){null!=f&&Q(f),S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var O=document.createElementNS("http://www.w3.org/2000/svg","g"),B="g"+R().toString();O.setAttributeNS(null,"id",B),O.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(O);var V=q(S);O.appendChild(V),f=O,b=O.children[0],V.setAttributeNS(null,"cx",C[0][0].toFixed(4)),V.setAttributeNS(null,"cy",C[0][1].toFixed(4)),V.setAttributeNS(null,"r",1),T=S}if("ellipse"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var _=document.createElementNS("http://www.w3.org/2000/svg","g");f=_;var j="g"+R().toString();_.setAttributeNS(null,"id",j),_.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(_);var G=q("ellipse");_.appendChild(G),b=_.children[0],G.setAttributeNS(null,"cx",C[0][0].toFixed(4)),G.setAttributeNS(null,"cy",C[0][1].toFixed(4)),G.setAttributeNS(null,"rx",1),G.setAttributeNS(null,"ry",1),T=S}else T=!1,W(b);if("draw"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var D=document.createElementNS("http://www.w3.org/2000/svg","g");f=D;var z="g"+R().toString();D.setAttributeNS(null,"id",z),D.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(D);var $=q("polyline");D.appendChild($),b=D.children[0],$.setAttributeNS(null,"points",C[0][0].toFixed(4).toString()+","+C[0][1].toFixed(4).toString()+" "),T=S}else T=!1,J(b);if("cubic"==S||"quadratic"==S)if(0==T){S,C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a];var Z=document.createElementNS("http://www.w3.org/2000/svg","g");f=Z;var K="g"+R().toString();Z.setAttributeNS(null,"id",K),Z.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(Z);var Y=q("path");Z.appendChild(Y),b=Z.children[0];var X=C[0][0],tt=C[0][1];Y.setAttributeNS(null,"d",U(X,tt,X,tt,X,tt,X,tt)),T=S}else T=!1,W(b);var et;if("text"==S&&(b&&Ht(),0==T)){C[0]=[(t.lastMousePoint.x-x)/a,(t.lastMousePoint.y-y)/a],S,et=document.createElementNS("http://www.w3.org/2000/svg","g"),f=et;var rt,nt="g"+R().toString();et.setAttributeNS(null,"id",nt),et.setAttributeNS(null,"class",S),document.getElementById("xlt").appendChild(et),rt=document.createElementNS("http://www.w3.org/2000/svg","text"),et.appendChild(rt),b=et.children[0],rt.setAttributeNS(null,"stroke",i),rt.setAttributeNS(null,"stroke-width","1"),rt.setAttributeNS(null,"stroke-opacity","1.0"),rt.setAttributeNS(null,"x",C[0][0].toFixed(4)),rt.setAttributeNS(null,"y",C[0][1].toFixed(4)),rt.setAttributeNS(null,"style","font-family: "+I+"; fill: "+i.toString()+";"),rt.setAttributeNS(null,"font-size",P),rt.innerHTML="_",T="text"}return"MOVE"==S&&0==T&&(T=S),H=!1,e.preventDefault()&&!1}},j.prototype.onSvgMouseMove=function(){var t=this;return function(e){return t.renderFunction(e),e.preventDefault(),!1}};function xt(t){var e=t.key,r=t.keyCode,n=(t.charCode,t.shiftKey);t.ctrlKey;if(20==r)return M=!M,!1;var i=V[r];return i?n&&_[i]?_[i]:i:r>47&&r<58?(e=String.fromCharCode(r),n?_[e]:e):(r>63&&r<91||32==r)&&(e=String.fromCharCode(r),M?F?e.toUpperCase():n?e.toLowerCase():e.toUpperCase():n?e:e.toLowerCase())}function yt(){T=!1,W(f),wt("MOVE"),h=null,b=null,f=null}function St(){if("polygon"==S||"polyline"==S){switch(T=!1,S){case"polygon":Et(b),f.innerHTML=f.innerHTML.replace("polyline","polygon").replace("polyline","polygon"),W(f);break;case"polyline":Et(b),W(f);break}"text"==S&&Ot(),b=null,f=null}}function Et(t){var e=t.attributes["points"].value.trim(),r=e.split(" ");e=r[0]+" ";for(var n=1;n<r.length;n++)Nt(r[n-1],r[n])&&(e+=r[n]+" ");b.attributes["points"].value=e}function At(t){var e=t.attributes["points"].value.trim(),r=e.split(" ");e=r[0]+" ";for(var n=1;n<r.length-1;n++)r[n]!=r[n-1]&&(e+=r[n]+" ");b.attributes["points"].value=e}function Nt(t,e){var r=t.split(","),n=e.split(","),i=r[0],a=r[1],o=n[0],u=n[1];return!(Math.abs(i-o)<1e-6*o&&Math.abs(a-u)<1e-6*u)}function wt(t){b&&(Ct(),Q(f)),"MOVE"==t.toUpperCase()?(S=t,Ut(B,"@setCursorMode1 cursorMode = "+S)):(S=t.toLowerCase(),"rectangle"==t&&(S="rect",Ut(B,"@setCursorMode2 cursorMode = "+S)),"clear"==t&&(Ft(),S="MOVE"),"reset"==t&&(Pt(0,0,u),S="MOVE")),"MOVE","MOVE"!=S.toUpperCase()&&(H=!0,Ut(B,"@setCursorMode3 waitElement = "+S)),jt(S),T=!1}function Ct(){switch(S){case"polyline":case"polygon":break;case"circle":if(null==b)return;(b.attributes["cy"].value-b.attributes["r"].value<0||b.attributes["r"].value<2)&&Ft();break;case"ellipse":if(null==b)return;b.attributes["cy"].value-b.attributes["ry"].value<0&&Ft();break;case"rect":if(null==b)return;b.attributes["height"].value<0&&Ft();break;case"line":b.attributes["y2"].value<0&&Ft();break;case"text":Ht();break}}function Ft(){var t=document.getElementById("xlt");if(t.childElementCount>1){var e=t.lastChild;e.removeEventListener("mouseenter",Z),e.removeEventListener("mouseleave",K),e.remove(),H=!1}}function Mt(){if(a<N){var t=a*(1+w);t>N&&(t=N),x=m-(m-x)*t/a,y=g-(g-y)*t/a,Pt(x,y,t),a=t,o=(E/a).toString(),document.getElementById("zoom").innerHTML="Zoom:"+a.toFixed(4)}}function kt(){if(a>u/3){var t=a/(1+w);x=m-(m-x)*t/a,y=g-(g-y)*t/a,Pt(x,y,t),a=t,o=(E/a).toString(),document.getElementById("zoom").innerHTML="Zoom:"+a.toFixed(4)}}function Pt(t,e,r){var n=document.getElementById("xlt"),i="translate("+t.toString()+", "+e.toString()+") scale("+r.toString()+")";a=r,x=t,y=e,n.attributes["transform"].value=i,document.getElementById("zoom").innerHTML="Zoom:"+a.toFixed(4)}function It(t){p=t.key;var e,r=t.keyCode;if(p=xt(t),null==b)return 8==r&&t.preventDefault(),!1;if(13==t.keyCode&&t.shiftKey)return Ht(),!1;if(e=k.slice(0,k.length-1),r>31&&(k=e+p+"_"),8==r&&(k=e.slice(0,e.length-1)+"_",t.preventDefault()),p||13==r||8==r){b.innerHTML=Lt(k),b.attributes["stroke"].value=i,b.attributes["style"].value="font-family: "+I+"; fill: "+i+";",b.attributes["font-size"].value=P;var n=b.attributes["x"].value,a=parseInt(b.attributes["y"].value)+parseInt(P),o=b.cloneNode();13==t.keyCode&&(b.innerHTML=Lt(e.slice(0,e.length)),o.attributes["x"].value=n,o.attributes["y"].value=a,b.parentElement.appendChild(o),b=o,b.innerHTML="_",k="_",t.preventDefault())}}function Lt(t){var e=t.replace(/  /g," &nbsp;");return e=e.replace(/</g,"&lt;").replace(/>/g,"&gt"),e}function Ht(){if(Tt(),f){if(f.hasChildNodes())W(f);else{f.remove()}Ot(),f=null}}function Tt(){if(b&&b.parentElement)if("_"==b.parentElement.lastChild.innerHTML)b.parentElement.lastChild.remove(),k="_",b=null;else if("text"==T){if(b.innerHTML=Lt(k.slice(0,k.length-1)),""==b.innerHTML){b.remove(),b=null}if("g"==f.lastChild.tagName){f.lastChild.remove}}}function Ot(){k="_",C=[],b=null,T=!1}function Bt(t){i=t,document.getElementById("cursorColor").attributes["style"].value="background-color: "+i}function Vt(t){var e=document.getElementById("selectUserColor");e.attributes["style"].value="background-color: "+t,e.blur()}function _t(){return document.getElementById("userColor").value}function jt(t){var e=t;"rect"==t&&(e="rectangle"),document.getElementById("mode").textContent=e.toUpperCase(),document.getElementById("zoom").innerHTML="Zoom:"+a.toFixed(4)}function Gt(t){var e,r=l.cloneNode(!0),n=r.firstChild;t||(r.removeAttribute("height"),r.removeAttribute("width"),r.firstChild.attributes["transform"].value="translate(0, 0) scale(1)",n.children["xltImage"].remove());var i,a=n.childElementCount;for(i=0;i<a;i++)e=n.childNodes[i],t||e.attributes.class&&e.removeAttribute("id");return r}function Dt(t){var e=l.cloneNode(!0);e.removeAttribute("height"),e.removeAttribute("width"),e.removeAttribute("id");var r,n,i=e.firstChild;i.removeAttribute("id"),i.removeAttribute("transform"),i.children["xltImage"].remove();var a=i.childElementCount,o=["arrow","cubic","quadratic","text"];for(n=0;n<a;n++)r=i.childNodes[n],r.attributes.class&&(Rt(r),t&&!o.includes(r.attributes.class.value)&&(r.outerHTML=r.innerHTML));return e}function Rt(t){var e;if(t.hasChildNodes())for(e=0;e<t.childElementCount;e++)Rt(t.childNodes[e]);return t.removeAttribute("id"),t.removeAttribute("stroke"),t.removeAttribute("stroke-width"),t.removeAttribute("stroke-opacity"),t.removeAttribute("stroke-linecap"),t.removeAttribute("fill"),t.removeAttribute("fill-opacity"),t.removeAttribute("font-family"),t.removeAttribute("font-size"),t.removeAttribute("style"),t}function Ut(t,e){return!!t&&(console.log(e),!0)}function zt(){P=document.getElementById("textHeight").value}j.prototype.updateMousePosition=function(t){var e;e=this.touchSupported?t.originalEvent.touches[0]:t;var r=c;this.lastMousePoint.x=e.pageX-r.left,this.lastMousePoint.y=e.pageY-r.top,m=this.lastMousePoint.x,g=this.lastMousePoint.y},j.prototype.updateSvgByElement=function(t){if("MOVE"!=S){if("polygon"==S||"polyline"==S&&"polygon"==T){if(0==T)return;if(this.updateMousePosition(t),"SHIFT"==T){((m-x)/a).toFixed(4).toString(),((g-y)/a).toFixed(4).toString();var e=b.attributes["points"].value.trim(),r=e.split(" ");if(null!=h){var n=parseFloat(h.attributes["cx"].value),i=parseFloat(h.attributes["cy"].value),o=(m-x)/a,u=(g-y)/a,l=o-n,s=u-i;h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a;var c,d="",p=[],v=[];for(c=0;c<r.length;c++){var E=r[c].split(",");p[c]=(parseFloat(E[0])+l).toFixed(4),v[c]=(parseFloat(E[1])+s).toFixed(4),d+=p[c]+","+v[c]+" "}for(var A=0;A<r.length;A++)e+=r[A]+" ";b.attributes["points"].value=d}}else{var N=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString(),w=b.attributes["points"].value.trim(),C=w.split(" ");if(null!=h){if(h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,mt(h.id)){C[parseInt(h.id)]=N,w="";for(var F=0;F<C.length;F++)w+=C[F]+" ";b.attributes["points"].value=w}}else{w="";for(var M=0;M<C.length-1;M++)w+=C[M]+" ";N+=" ",b.attributes["points"].value=w.concat(N)}}}else if("polyline"==S){if(0==T)return;if(this.updateMousePosition(t),"SHIFT"==T){((m-x)/a).toFixed(4).toString(),((g-y)/a).toFixed(4).toString();var k=b.attributes["points"].value.trim(),I=k.split(" ");if(null!=h){var H=parseFloat(h.attributes["cx"].value),O=parseFloat(h.attributes["cy"].value),V=(m-x)/a,_=(g-y)/a,j=V-H,R=_-O;h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a;var J,Z="",K=[],W=[];for(J=0;J<I.length;J++){var Y=I[J].split(",");K[J]=(parseFloat(Y[0])+j).toFixed(4),W[J]=(parseFloat(Y[1])+R).toFixed(4),Z+=K[J]+","+W[J]+" "}for(var Q=0;Q<I.length;Q++)k+=I[Q]+" ";b.attributes["points"].value=Z}}else{var X=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString(),tt=b.attributes["points"].value.trim(),et=tt.split(" ");if(null!=h){if(h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,mt(h.id)){et[parseInt(h.id)]=X,tt="";for(var rt=0;rt<et.length;rt++)tt+=et[rt]+" ";b.attributes["points"].value=tt}}else{tt="";for(var nt=0;nt<et.length-1;nt++)tt+=et[nt]+" ";X+=" ",b.attributes["points"].value=tt.concat(X)}}}else if("rect"==S){if(0==T)return;if("SHIFT"==T)this.updateMousePosition(t),h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,b.attributes["x"].value=((m-x)/a).toFixed(4),b.attributes["y"].value=((g-y)/a).toFixed(4);else{var it=b.attributes["x"].value,at=b.attributes["y"].value;this.updateMousePosition(t),b.attributes["width"].value=((m-x)/a-it).toFixed(4),b.attributes["height"].value=((g-y)/a-at).toFixed(4),h&&(h=t.target,h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a)}}else if("line"==S){var ot;if(m=this.lastMousePoint.x,g=this.lastMousePoint.y,"mousedown"==t.type||0==T)return void Ut(B,"cursorMode=line abort event:"+t.type+" svgInProgress= "+T);if("SHIFT"==T){this.updateMousePosition(t);var ut=parseFloat(b.attributes["x1"].value),lt=parseFloat(b.attributes["y1"].value),st=parseFloat(b.attributes["x2"].value),ct=parseFloat(b.attributes["y2"].value),dt=parseFloat(h.attributes["cx"].value),pt=parseFloat(h.attributes["cy"].value),vt=(m-x)/a,ft=(g-y)/a,bt=dt-vt,ht=ft-pt;h&&(h.attributes["cx"].value=vt,h.attributes["cy"].value=ft,b.attributes["x1"].value=(ut-bt).toFixed(4),b.attributes["y1"].value=(ht+lt).toFixed(4),b.attributes["x2"].value=(st-bt).toFixed(4),b.attributes["y2"].value=(ht+ct).toFixed(4))}else this.updateMousePosition(t),ot=["x2","y2"],null!=h&&(h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,mt(h.id)||(ot=h.id.split("-")),"shift"==f.lastChild.firstChild.id&&f.lastChild.firstChild.remove()),b.attributes[ot[0]].value=((m-x)/a).toFixed(4),b.attributes[ot[1]].value=((g-y)/a).toFixed(4),Ut(B,"x: "+((m-x)/a).toString()+" / y: "+((g-y)/a).toString())}else if("arrow"==S){var xt;if(m=this.lastMousePoint.x,g=this.lastMousePoint.y,"mousedown"==t.type||0==T)return;var yt=f.children[0];if(this.updateMousePosition(t),"SHIFT"==T){var St=parseFloat(yt.attributes["x1"].value),Et=parseFloat(yt.attributes["y1"].value),At=parseFloat(yt.attributes["x2"].value),Nt=parseFloat(yt.attributes["y2"].value);h||(h=yt.parentElement.lastChild.children["shift"]);var wt=parseFloat(h.attributes["cx"].value),Ct=parseFloat(h.attributes["cy"].value),Ft=(m-x)/a,Mt=(g-y)/a,kt=wt-Ft,It=Mt-Ct;h.attributes["cx"].value=Ft,h.attributes["cy"].value=Mt,yt.attributes["x1"].value=(St-kt).toFixed(4),yt.attributes["y1"].value=(It+Et).toFixed(4),yt.attributes["x2"].value=(At-kt).toFixed(4),yt.attributes["y2"].value=(It+Nt).toFixed(4)}else xt=["x2","y2"],null!=h&&(h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,mt(h.id)||(xt=h.id.split("-"))),yt.attributes[xt[0]].value=((m-x)/a).toFixed(4),yt.attributes[xt[1]].value=((g-y)/a).toFixed(4);while(f.childElementCount>1)f.lastChild.remove();var Lt=b.attributes["x1"].value,Ht=b.attributes["y1"].value,Tt=b.attributes["x2"].value,Ot=b.attributes["y2"].value,Bt=b.attributes["stroke"].value,Vt=b.attributes["stroke-width"].value,_t=Tt-Lt,jt=Ot-Ht,Gt=Math.sqrt(_t*_t+jt*jt);0==Gt&&(Gt=1);var Dt,Rt=_t/Gt,zt=jt/Gt;Dt=document.getElementById("arrowHeadPixels").checked?document.getElementById("arrowHeadLength").value:Gt*L/100;var $t=parseFloat(Tt)-Rt*Dt,qt=parseFloat(Ot)-zt*Dt,Jt=($t+Dt*zt/2).toFixed(4),Zt=(qt-Dt*Rt/2).toFixed(4),Kt=($t-Dt*zt/2).toFixed(4),Wt=(qt+Dt*Rt/2).toFixed(4),Yt=q("line");Yt.setAttributeNS(null,"x1",Tt),Yt.setAttributeNS(null,"y1",Ot),Yt.setAttributeNS(null,"x2",Jt),Yt.setAttributeNS(null,"y2",Zt),Yt.setAttributeNS(null,"stroke",Bt),Yt.setAttributeNS(null,"stroke-width",Vt);var Qt=q("line");if(Qt.setAttributeNS(null,"x1",Tt),Qt.setAttributeNS(null,"y1",Ot),Qt.setAttributeNS(null,"x2",Kt),Qt.setAttributeNS(null,"y2",Wt),Qt.setAttributeNS(null,"stroke",Bt),Qt.setAttributeNS(null,"stroke-width",Vt),document.getElementById("arrowHeadClosed").checked){var Xt=q("polygon"),te=Tt+","+Ot+" "+Jt+","+Zt+" "+Kt+","+Wt;Xt.setAttributeNS(null,"points",te),Xt.setAttributeNS(null,"stroke",Bt),Xt.setAttributeNS(null,"stroke-width",Vt),f.appendChild(Xt)}else f.appendChild(Yt),f.appendChild(Qt)}else if("circle"==S){if("mousedown"==t.type||0==T)return;if("SHIFT"==T)this.updateMousePosition(t),h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,b.attributes["cx"].value=((m-x)/a).toFixed(4),b.attributes["cy"].value=((g-y)/a).toFixed(4);else{var ee=b.attributes["cx"].value,re=b.attributes["cy"].value;this.updateMousePosition(t),m=this.lastMousePoint.x,g=this.lastMousePoint.y;var ne=gt(ee,re,(m-x)/a,(g-y)/a);if(b.attributes["r"].value=ne.toFixed(4),h)switch(h=t.target,h.id){case"E":h.attributes["cx"].value=parseFloat(ee)+ne;break;case"S":h.attributes["cy"].value=parseFloat(re)+ne;break;case"W":h.attributes["cx"].value=parseFloat(ee)-ne;break;case"N":h.attributes["cy"].value=parseFloat(re)-ne;break}var ie=t.target.parentElement.children;ie["E"]&&(ie["E"].attributes["cx"].value=parseFloat(ee)+ne,ie["S"].attributes["cy"].value=parseFloat(re)+ne,ie["W"].attributes["cx"].value=parseFloat(ee)-ne,ie["N"].attributes["cy"].value=parseFloat(re)-ne)}}else if("ellipse"==S){if(m=this.lastMousePoint.x,g=this.lastMousePoint.y,"mousedown"==t.type||0==T)return;if("SHIFT"==T)this.updateMousePosition(t),h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,b.attributes["cx"].value=((m-x)/a).toFixed(4),b.attributes["cy"].value=((g-y)/a).toFixed(4);else{var ae=b.attributes["cx"].value,oe=b.attributes["cy"].value;this.updateMousePosition(t),m=this.lastMousePoint.x,g=this.lastMousePoint.y,b.attributes["rx"].value=(1.414*Math.abs(ae-(m-x)/a)).toFixed(4),b.attributes["ry"].value=(1.414*Math.abs(oe-(g-y)/a)).toFixed(4)}}else if("draw"==S){if(0==T)return;if(this.updateMousePosition(t),"SHIFT"==T){((m-x)/a).toFixed(4).toString(),((g-y)/a).toFixed(4).toString();var ue=b.attributes["points"].value.trim(),le=ue.split(" ");if(null!=h){var se=parseFloat(h.attributes["cx"].value),ce=parseFloat(h.attributes["cy"].value),de=(m-x)/a,pe=(g-y)/a,ve=de-se,fe=pe-ce;h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a;var be,he="",me=[],ge=[];for(be=0;be<le.length;be++){var xe=le[be].split(",");me[be]=(parseFloat(xe[0])+ve).toFixed(4),ge[be]=(parseFloat(xe[1])+fe).toFixed(4),he+=me[be]+","+ge[be]+" "}for(var ye=0;ye<le.length;ye++)ue+=le[ye]+" ";b.attributes["points"].value=he}}else{var Se=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString(),Ee=b.attributes["points"].value.trim(),Ae=Ee.split(" ");if(null!=h){if(h.attributes["cx"].value=(m-x)/a,h.attributes["cy"].value=(g-y)/a,mt(h.id)){Ae[parseInt(h.id)]=Se,Ee="";for(var Ne=0;Ne<Ae.length;Ne++)Ee+=Ae[Ne]+" ";b.attributes["points"].value=Ee}}else{var we=b.attributes["points"].value,Ce=((m-x)/a).toFixed(4).toString()+","+((g-y)/a).toFixed(4).toString()+" ";b.attributes["points"].value=we.concat(Ce)}}}else if("cubic"==S||"quadratic"==S){if(m=this.lastMousePoint.x,g=this.lastMousePoint.y,"mousedown"==t.type||0==T)return;this.updateMousePosition(t);var Fe=b.attributes["d"].value,Me=Fe.indexOf("Q ")>0;if(null!=h){var ke=(m-x)/a,Pe=(g-y)/a,Ie=parseFloat(h.attributes["cx"].value),Le=parseFloat(h.attributes["cy"].value);Ut(B,"endpoints: ["+ke+", "+Pe+"], ["+Ie+", "+Le+"]");var He=ke-Ie,Te=Pe-Le;h.attributes["cx"].value=ke,h.attributes["cy"].value=Pe;var Oe=z(Fe);if("shift"==h.id){Ut(B,Fe),Ut(B,"dx: "+He+", dy: "+Te);for(var Be=0;Be<Oe.length;Be++)Oe[Be]=(He+parseFloat(Oe[Be])).toFixed(4),Oe[Be+1]=(Te+parseFloat(Oe[Be+1])).toFixed(4),Be++;Me&&(Oe[6]=Oe[4],Oe[7]=Oe[5]),b.attributes["d"].value=U(Oe[0],Oe[1],Oe[2],Oe[3],Oe[4],Oe[5],Oe[6],Oe[7]),Ut(B,b.attributes["d"].value)}else{switch(Me&&(Oe[6]=Oe[4],Oe[7]=Oe[5]),h.id){case"p1":Oe[0]=ke.toFixed(4),Oe[1]=Pe.toFixed(4);break;case"p2":Oe[6]=ke.toFixed(4),Oe[7]=Pe.toFixed(4);break;case"c1":Oe[2]=ke.toFixed(4),Oe[3]=Pe.toFixed(4);break;case"c2":Oe[4]=ke.toFixed(4),Oe[5]=Pe.toFixed(4);break}Me&&(Oe[4]=Oe[2],Oe[5]=Oe[3]),b.attributes["d"].value=U(Oe[0],Oe[1],Oe[2],Oe[3],Oe[4],Oe[5],Oe[6],Oe[7]),b.parentElement.lastChild.children["l1"].attributes["x1"].value=Oe[0],b.parentElement.lastChild.children["l1"].attributes["y1"].value=Oe[1],b.parentElement.lastChild.children["l1"].attributes["x2"].value=Oe[2],b.parentElement.lastChild.children["l1"].attributes["y2"].value=Oe[3],b.parentElement.lastChild.children["l2"].attributes["x1"].value=Oe[4],b.parentElement.lastChild.children["l2"].attributes["y1"].value=Oe[5],b.parentElement.lastChild.children["l2"].attributes["x2"].value=Oe[6],b.parentElement.lastChild.children["l2"].attributes["y2"].value=Oe[7],b.parentElement.lastChild.children["poly"].attributes["points"].value=$(Oe)+Oe[0]+", "+Oe[1]}}else{var Ve,_e=(m-x)/a,je=(g-y)/a,Ge=" C ";"quadratic"==S&&(Ge=" Q ");var De=Fe.split(Ge),Re=De[0].split("M ");Re=Re[1].split(", ");var Ue=parseInt(Re[0]),ze=parseInt(Re[1]),$e=Ue-_e,qe=ze-je,Je=De[1].split(", ");" Q "==Ge?(Je[0]=(Ue-.4*$e).toFixed(4),Je[1]=(ze-.4*qe).toFixed(4),Ve=De[0]+Ge+D(Je[0],Je[1])):(Je[0]=(Ue-.4*$e).toFixed(4),Je[1]=(ze-.4*qe).toFixed(4),Je[2]=(Ue-.6*$e).toFixed(4),Je[3]=(ze-.6*qe).toFixed(4),Ve=De[0]+Ge+D(Je[0],Je[1]),Ve+=D(Je[2],Je[3]),Ve+=D(_e,je),Ut(B,"p1: "+Re[0]+", "+Re[1]),Ut(B,"control points: "+Je[0]+", "+Je[1]+" ... "+Je[2]+", "+Je[3]),Ut(B,"p2: "+_e+", "+je)),Ve+=G(_e,je),b.attributes["d"].value=Ve}}else if("text"==S&&"SHIFT"==T){this.updateMousePosition(t),h||(h=t.target);var Ze=(m-x)/a,Ke=(g-y)/a;h.attributes["cx"].value=Ze,h.attributes["cy"].value=Ke;for(var We=0;We<f.children.length;We++)"text"==f.children[We].tagName?(f.children[We].attributes["x"].value=Ze.toFixed(4),f.children[We].attributes["y"].value=(Ke+We*P).toFixed(4)):(f.children[We].children[0].attributes["cx"].value=Ze,f.children[We].children[0].attributes["cy"].value=Ke)}}else if("MOVE"==S&&"MOVE"==T){var Ye=this.lastMousePoint.x,Qe=this.lastMousePoint.y;this.updateMousePosition(t),x-=Ye-m,y-=Qe-g,Pt(x,y,a)}return t.preventDefault()&&!1},j.prototype.onSvgMouseUp=function(t){return function(t){return T?("SHIFT"==T?(T=!1,Q(f)):"SIZE"==T?(T=!1,W(b.parentNode)):"bubble"==S?T=!1:"draw"==S?(T=!1,W(f)):"cubic"==S||"quadratic"==S?(T=!1,W(f)):"MOVE"==S?T=!1:"rect"==S?(T=!1,W(f),h=null,b=null,f=null):"line"==S?(T=!1,W(f),h=null,b=null,f=null):"arrow"==S?(T=!1,W(f),h=null,b=null,f=null):"polygon"==S?null==h||(T=!1,W(f),h=null,b=null,f=null):"polyline"==S?null==h||(T=!1,W(f),h=null,b=null,f=null):"circle"==S?(T=!1,W(f),h=null,b=null,f=null):"ellipse"==S?(T=!1,W(f),h=null,b=null,f=null):"text"==S&&0==T&&("circle"==f.lastChild.tagName&&Q(group),W(f)),C=[],!1):t.preventDefault()&&!1}},j.prototype.keyUpHandler=function(){return function(t){20==t.keyCode&&(M=!M)}},j.prototype.keyHandler=function(){return function(t){var e=t.keyCode,r=document.activeElement;switch(e){case 16:return p="Shift",v,void(v=p);case 20:return void(M=!M);case 93:return p="Meta",v,void(v=p);case 82:t.shiftKey&&(t.ctrlKey||t.metaKey)&&location.reload(!0);case 66:if(t.ctrlKey&&f){var n=f.cloneNode(!0);f.remove(),Q(n),l.firstChild.insertBefore(n,l.firstChild.childNodes[1])}case 84:if(t.ctrlKey&&f){var i=f.cloneNode(!0);f.remove(),Q(i),l.firstChild.appendChild(i)}default:null,v=p}if("text"!=S||"BODY"!=r.tagName&&r.id!=l.parentElement.id){if("Enter"==t.key||13==e)switch(S){case"polygon":return void St();case"polyline":return void St();case"line":return void yt();case"rectangle":return void yt();case"circle":return void yt();case"ellipse":return void yt();case"cubic":return void yt();case"quadratic":return void yt();case"draw":return void yt()}if("Delete"==t.key||"Backspace"==t.key||46==e||8==e){if(t.shiftKey){if(f){var a=f.cloneNode(!0);f.remove(),Q(a),l.firstChild.appendChild(a),Ft()}return}if("BODY"==r.tagName||r.id==l.parentElement.id)return void t.preventDefault()}if("Escape"!=t.key&&27!=e);else switch(S){case"polyline":if(T==S)return void At(b)}}else It(t)}},j.prototype.doubleClickHandler=function(){return function(){St()}},j.prototype.mouseWheelScrollHandler=function(){return function(t){t.stopImmediatePropagation(),t.stopPropagation();var e=1e3;"DOMMouseScroll"==t.type&&(e=100);var r=-parseInt(t.deltaY||-t.detail);m=t.clientX-c.left,g=t.clientY-c.top;var n=r/e;return n>0?Mt():kt(),t.preventDefault()&&!1}},j.prototype.setMode=function(t){wt(t)},j.prototype.apiShowSVG=function(t){d.children["textSVGorJSON"].textContent=Gt(t).outerHTML},j.prototype.apiBareSVG=function(){var t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];d.children["textSVGorJSON"].textContent=Dt(t).outerHTML},j.prototype.apiJsonSVG=function(t){var e=Gt(!1).firstChild;e.removeAttribute("id"),e.removeAttribute("transform");var r={data:{type:"svg",attributes:e.outerHTML}};return d.children["textSVGorJSON"].textContent=JSON.stringify(r),r},j.prototype.buildSVGmenu=function(t){t.attributes["data-buttons"]&&function(){var e,r,n,a=JSON.parse(t.attributes["data-buttons"].value).buttons;for(d=document.createElement("div"),d.setAttribute("id","svgMenu"),t.parentElement.appendChild(d),n=0;n<a.length;n++){var o=a[n].function,u=a[n].value;(function(){switch(o){case"clear":case"polygon":case"polyline":case"line":case"arrow":case"rectangle":case"circle":case"ellipse":case"quadratic":case"cubic":case"draw":case"text":case"MOVE":case"reset":e=document.createElement("input"),e.setAttribute("type","button"),u?e.setAttribute("value",u):e.setAttribute("value",a[n].function.charAt(0).toUpperCase()+a[n].function.slice(1)),e.setAttribute("id","b_"+a[n].function.toLowerCase()),d.appendChild(e);var t=a[n].function;e.addEventListener("click",(function(e){wt(t)}));break;case"mode":r=document.createElement("span"),r.setAttribute("id","mode"),d.appendChild(r);break;case"zoomin":e=document.createElement("input"),e.setAttribute("type","button"),e.setAttribute("value","Zoom IN"),e.setAttribute("id","b_zoomin"),d.appendChild(e),e.addEventListener("click",(function(t){e.blur(),Mt()}));break;case"zoom":e=document.createElement("span"),e.setAttribute("id","zoom"),e.setAttribute("innerHTML"," Zoom:  ----"),d.appendChild(e);break;case"zoomout":e=document.createElement("input"),e.setAttribute("type","button"),e.setAttribute("value","Zoom OUT"),e.setAttribute("id","b_zoomout"),d.appendChild(e),e.addEventListener("click",(function(t){e.blur(),kt()}));break;case"textheight":r=document.createElement("span"),r.setAttribute("id","textBlock"),d.appendChild(r);var l=document.createElement("span");l.innerHTML=" Text Size: ",r.appendChild(l),e=document.createElement("input"),e.setAttribute("id","textHeight"),e.setAttribute("type","number"),e.setAttribute("min","5"),e.setAttribute("step","5"),e.setAttribute("max","300"),e.setAttribute("style","width: 4em"),e.setAttribute("value","75"),r.appendChild(e),e.addEventListener("change",(function(t){zt()}));break;case"newline":d.appendChild(document.createElement("br")),r=document.createElement("span"),r.innerHTML="Select color: ",d.appendChild(r);break;case"colorselect":var s={buttons:[{color:"#FF0000"},{color:"#00FF00"},{color:"#0000FF"},{color:"#000000"},{color:"#666666"},{color:"#FF0000"}]},c=void 0;for(c=0;c<s.buttons.length;c++)if(4==c&&(e=document.createElement("input"),e.setAttribute("id","userColor"),e.setAttribute("type","text"),e.setAttribute("value",s.buttons[c].color),e.setAttribute("style","width: 5em"),d.appendChild(e),e.addEventListener("change",(function(t){Vt(_t()),e.blur()})),e=document.createElement("input"),e.setAttribute("id","selectUserColor"),e.setAttribute("type","button"),e.setAttribute("style","background-color: "+s.buttons[c].color),d.appendChild(e),e.addEventListener("click",(function(t){Bt(_t()),e.blur()}))),c<s.buttons.length-2&&function(){e=document.createElement("input"),e.setAttribute("type","button"),e.setAttribute("style","background-color: "+s.buttons[c].color),d.appendChild(e);var t=s.buttons[c].color;e.addEventListener("click",(function(r){Bt(t),e.blur()}))}(),c>s.buttons.length-2){var p=document.createElement("span");p.innerHTML=" Selected Color >",d.appendChild(p),e=document.createElement("input"),e.setAttribute("id","cursorColor"),e.setAttribute("type","button"),e.setAttribute("style","background-color: "+s.buttons[c].color),d.appendChild(e),i=s.buttons[c].color}break;case"arrowspecs":r=document.createElement("span"),r.setAttribute("id","arrowBlock"),r.innerHTML+=" &nbsp;Arrowhead: Closed:",e=document.createElement("input"),e.setAttribute("id","arrowHeadClosed"),e.setAttribute("type","checkbox"),r.appendChild(e),e.addEventListener("click",(function(t){document.getElementById("arrowHeadClosed").checked})),r.innerHTML+=" &nbsp; Fixed:",e=document.createElement("input"),e.setAttribute("id","arrowHeadPixels"),e.setAttribute("type","checkbox"),r.appendChild(e),e.addEventListener("click",(function(t){document.getElementById("arrowHeadPixels").checked})),r.innerHTML+=" &nbsp; Length:",e=document.createElement("input"),e.setAttribute("id","arrowHeadLength"),e.setAttribute("type","number"),e.setAttribute("value","50"),e.setAttribute("style","width: 4em"),r.appendChild(e),e.addEventListener("change",(function(t){j.prototype.apiArrowLength()})),r.innerHTML+=" &nbsp; Percent:",e=document.createElement("input"),e.setAttribute("id","arrowHeadPercent"),e.setAttribute("type","number"),e.setAttribute("min","5"),e.setAttribute("step","1"),e.setAttribute("max","30"),e.setAttribute("style","width: 4em"),e.setAttribute("value","10"),r.appendChild(e),r.addEventListener("change",(function(t){e.blur(),L=parseFloat(document.getElementById("arrowHeadPercent").value)})),d.appendChild(r);break;case"json":e=document.createElement("input"),e.setAttribute("id","saveSVG"),e.setAttribute("type","button"),e.setAttribute("value","Extract SVG"),d.appendChild(e),e.addEventListener("click",(function(t){e.blur(),j.prototype.apiShowSVG(!0)})),e=document.createElement("input"),e.setAttribute("id","plainSVG"),e.setAttribute("type","button"),e.setAttribute("value","Plain SVG"),d.appendChild(e),e.addEventListener("click",(function(t){e.blur(),j.prototype.apiShowSVG(!1)})),e=document.createElement("input"),e.setAttribute("id","bareSVG"),e.setAttribute("type","button"),e.setAttribute("value","Bare SVG"),d.appendChild(e),e.addEventListener("click",(function(t){e.blur(),j.prototype.apiBareSVG()})),e=document.createElement("input"),e.setAttribute("id","svgJSON"),e.setAttribute("type","button"),e.setAttribute("value","JSON SVG"),d.appendChild(e),e.addEventListener("click",(function(t){j.prototype.apiJsonSVG(!1)})),d.appendChild(document.createElement("br"));var v=document.createElement("textarea");v.setAttribute("id","textSVGorJSON"),d.appendChild(v);break}})()}}()},j.prototype.apiTextHeight=function(t){mt(t)&&(P=t)},j.prototype.apiArrowClosed=function(t){t},j.prototype.apiArrowFixed=function(t){t},j.prototype.apiArrowLength=function(t){t?mt(t)&&t:parseFloat(document.getElementById("arrowHeadLemgth").value)},j.prototype.apiArrowPercent=function(t){mt(t)&&(L=t)},j.prototype.apiStrokeWidth=function(t){mt(t)&&(A=t)};var $t=j,qt=(new $t(document.getElementById("container")),document.getElementById("container")),Jt=document.getElementById("image_file");function Zt(t){var e=t.target.files,r=qt.children[0];r&&r.parentNode.removeChild(r);var n=document.getElementById("svgMenu");if(n&&n.parentNode.removeChild(n),FileReader&&e&&e.length){var i=new FileReader;i.onload=function(t){qt.attributes["data-image"].value=i.result,new $t(qt)},i.readAsDataURL(e[0])}}Jt.addEventListener("change",(function(t){Zt(t)}))},fdef:function(t,e){t.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"}})}));
//# sourceMappingURL=svg-detailer.umd.min.js.map